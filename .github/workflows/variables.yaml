
name: exploring variables and secrets

on: 
  push 

env:
  CONTAINER_REGISTRY: docker.io 
  IMAGE_NAME: github-actions-nginx 

jobs: 
  docker: 
    runs-on: ubuntu-latest 
    steps: 
    - name: docker build 
      run: echo docker build -t ${{ env.CONTAINER_REGISTRY }}/${{ vars.DOCKER_USERNAME}}/$IMAGE_NAME:latest 

    - name: docker login 
      run: echo docker login --username=${{ vars.DOCKER_USERNAME}} --password=${{ secrets.DOCKER_PASSWORD }}

    - name: docker push
      run: echo docker push $CONTAINER_REGISTRY/${{ vars.DOCKER_USERNAME}}/$IMAGE_NAME:latest

  deploy:
    needs: docker
    runs-on: ubuntu-latest
    steps:
    - name: docker run
      run: echo docker run -d -p 80:80 $CONTAINER_REGISTRY/${{ vars.DOCKER_USERNAME}}/$IMAGE_NAME:latest


